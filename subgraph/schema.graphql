type Badge @entity(immutable: false) {
  id: ID!
  tokenId: BigInt!
  owner: User!
  badgeType: String!
  zkProofHash: Bytes!
  issuedAt: BigInt!
  txHash: Bytes!
  blockNumber: BigInt!
}

type Passport @entity(immutable: false) {
  id: ID!
  tokenId: BigInt!
  owner: User!
  creditScore: BigInt!
  pohScore: BigInt!
  badgeCount: BigInt!
  onchainActivity: BigInt!
  issuedAt: BigInt!
  lastUpdated: BigInt!
  txHash: Bytes!
  blockNumber: BigInt!
  scoreHistory: [ScoreUpdate!]! @derivedFrom(field: "passport")
}

type ScoreUpdate @entity(immutable: true) {
  id: ID!
  passport: Passport!
  oldScore: BigInt!
  newScore: BigInt!
  timestamp: BigInt!
  txHash: Bytes!
  blockNumber: BigInt!
}

type User @entity(immutable: false) {
  id: ID!
  address: Bytes!
  badges: [Badge!]! @derivedFrom(field: "owner")
  passports: [Passport!]! @derivedFrom(field: "owner")
  totalBadges: BigInt!
  totalPassports: BigInt!
  createdAt: BigInt!
  lastActivity: BigInt!
}

type GlobalStats @entity(immutable: false) {
  id: ID!
  totalBadges: BigInt!
  totalPassports: BigInt!
  totalUsers: BigInt!
  totalScoreUpdates: BigInt!
  averageCreditScore: BigInt!
  lastUpdated: BigInt!
}

type DailyStats @entity(immutable: false) {
  id: ID!
  date: Int!
  badgesMinted: BigInt!
  passportsIssued: BigInt!
  scoreUpdates: BigInt!
  newUsers: BigInt!
}
